<!-- ============================================ -->
<!--                 Navigation                   -->
<!-- ============================================ -->
{% set navPages = collections.all | eleventyNavigation %}
{% set currentLocale = locale | default(page.url | getLocale) %}
{% set urlPrefix = '/ko' if currentLocale == 'ko' else '' %}

<nav id="navbar" class="navbar">
    <div class="container nav-content">
        <!-- Mobile: Hamburger menu button -->
        <button id="menu-btn" class="menu-btn mobile-only" aria-expanded="false" aria-controls="mobile-menu">
            <div id="menu-icon-container" class="menu-icon-box">
                <i data-lucide="menu" width="20" height="20"></i>
            </div>
        </button>

        <!-- Desktop: Left navigation links with dropdowns -->
        <div class="nav-links-left desktop-only">
            <!-- Living dropdown -->
            <div class="nav-dropdown">
                <a href="{{ urlPrefix }}/blog/living/" class="nav-link nav-dropdown-trigger">
                    {{ 'nav.living' | t(currentLocale) }}
                    <i data-lucide="chevron-down" width="14" height="14" class="dropdown-arrow"></i>
                </a>
                <div class="nav-dropdown-menu">
                    <a href="{{ urlPrefix }}/blog/interiors/" class="nav-dropdown-item">{{ 'nav.interiors' | t(currentLocale) }}</a>
                    <a href="{{ urlPrefix }}/blog/wellness/" class="nav-dropdown-item">{{ 'nav.wellness' | t(currentLocale) }}</a>
                    <a href="{{ urlPrefix }}/blog/tech/" class="nav-dropdown-item">{{ 'nav.tech' | t(currentLocale) }}</a>
                </div>
            </div>

            <!-- Style dropdown -->
            <div class="nav-dropdown">
                <a href="{{ urlPrefix }}/blog/style/" class="nav-link nav-dropdown-trigger">
                    {{ 'nav.style' | t(currentLocale) }}
                    <i data-lucide="chevron-down" width="14" height="14" class="dropdown-arrow"></i>
                </a>
                <div class="nav-dropdown-menu">
                    <a href="{{ urlPrefix }}/blog/photography/" class="nav-dropdown-item">{{ 'nav.photography' | t(currentLocale) }}</a>
                </div>
            </div>

            <!-- Travel (no dropdown) -->
            <a href="{{ urlPrefix }}/blog/travel/" class="nav-link">{{ 'nav.travel' | t(currentLocale) }}</a>

            <!-- Work dropdown -->
            <div class="nav-dropdown">
                <a href="{{ urlPrefix }}/blog/work/" class="nav-link nav-dropdown-trigger">
                    {{ 'nav.work' | t(currentLocale) }}
                    <i data-lucide="chevron-down" width="14" height="14" class="dropdown-arrow"></i>
                </a>
                <div class="nav-dropdown-menu">
                    <a href="{{ urlPrefix }}/blog/essay/" class="nav-dropdown-item">{{ 'nav.essay' | t(currentLocale) }}</a>
                </div>
            </div>
            
            <!-- Food (no dropdown) -->
            <a href="{{ urlPrefix }}/blog/food/" class="nav-link">{{ 'nav.food' | t(currentLocale) }}</a>
        </div>

        <a href="{{ urlPrefix }}/" class="brand-logo" aria-label="{{ 'accessibility.goToHomepage' | t(currentLocale) }}">
            {{ client.name | upper | default('YOUNG CHAI') }}
            <svg class="brand-underline" viewBox="0 0 100 10" preserveAspectRatio="none">
                <path d="M0 5 Q 50 10 100 5" stroke="currentColor" stroke-width="2" fill="none" />
            </svg>
        </a>

        <!-- Desktop: Right navigation links -->
        <div class="nav-links-right desktop-only">
            <a href="{{ urlPrefix }}/about/" class="nav-link">{{ 'nav.about' | t(currentLocale) }}</a>
            <a href="{{ urlPrefix }}/contact/" class="nav-link">{{ 'nav.contact' | t(currentLocale) }}</a>
            {% include "language-switcher.html" %}
            <button id="search-btn" class="nav-link-btn" aria-label="{{ 'accessibility.searchSite' | t(currentLocale) }}">
                <i data-lucide="search" width="20" height="20" stroke-width="1.5"></i>
            </button>
        </div>

        <!-- Mobile: Search & Language -->
        <div class="nav-actions mobile-only">
            {% include "language-switcher.html" %}
            <button id="search-btn-mobile" aria-label="{{ 'accessibility.searchSite' | t(currentLocale) }}">
                <i data-lucide="search" width="24" height="24" stroke-width="1.5"></i>
            </button>
        </div>
    </div>
</nav>

<div id="mobile-menu" class="hidden" aria-hidden="true">
    <!-- Mobile menu header with close and search -->
    <div class="mobile-menu-header">
        <button id="menu-close-btn" class="mobile-menu-close" aria-label="Close menu">
            <i data-lucide="x" width="24" height="24"></i>
        </button>
        <a href="{{ urlPrefix }}/" class="mobile-menu-logo">
            {{ client.name | upper | default('YOUNG CHAI') }}
        </a>
        <button id="search-btn-menu" class="mobile-menu-search" aria-label="Search">
            <i data-lucide="search" width="22" height="22"></i>
        </button>
    </div>
    
    <nav class="mobile-menu-content" aria-label="Mobile navigation">
        <!-- Living category -->
        <div class="mobile-nav-group">
            <a href="{{ urlPrefix }}/blog/living/" class="mobile-category-heading cat-living">{{ 'nav.living' | t(currentLocale) }}</a>
            <div class="mobile-subnav">
                <a href="{{ urlPrefix }}/blog/interiors/" class="mobile-link-sub">{{ 'nav.interiors' | t(currentLocale) }}</a>
                <a href="{{ urlPrefix }}/blog/wellness/" class="mobile-link-sub">{{ 'nav.wellness' | t(currentLocale) }}</a>
                <a href="{{ urlPrefix }}/blog/tech/" class="mobile-link-sub">{{ 'nav.tech' | t(currentLocale) }}</a>
            </div>
        </div>

        <!-- Style category -->
        <div class="mobile-nav-group">
            <a href="{{ urlPrefix }}/blog/style/" class="mobile-category-heading cat-style">{{ 'nav.style' | t(currentLocale) }}</a>
            <div class="mobile-subnav">
                <a href="{{ urlPrefix }}/blog/photography/" class="mobile-link-sub">{{ 'nav.photography' | t(currentLocale) }}</a>
            </div>
        </div>

        <!-- Travel category -->
        <div class="mobile-nav-group">
            <a href="{{ urlPrefix }}/blog/travel/" class="mobile-category-heading cat-travel">{{ 'nav.travel' | t(currentLocale) }}</a>
            <div class="mobile-subnav">
                <!-- Add subcategories here as they grow -->
            </div>
        </div>

        <!-- Work category -->
        <div class="mobile-nav-group">
            <a href="{{ urlPrefix }}/blog/work/" class="mobile-category-heading cat-work">{{ 'nav.work' | t(currentLocale) }}</a>
            <div class="mobile-subnav">
                <a href="{{ urlPrefix }}/blog/essay/" class="mobile-link-sub">{{ 'nav.essay' | t(currentLocale) }}</a>
            </div>
        </div>

        <!-- Food category -->
        <div class="mobile-nav-group">
            <a href="{{ urlPrefix }}/blog/food/" class="mobile-category-heading cat-food">{{ 'nav.food' | t(currentLocale) }}</a>
            <div class="mobile-subnav">
                <!-- Add subcategories here as they grow -->
            </div>
        </div>

        <!-- Footer links -->
        <div class="mobile-menu-footer">
            <a href="{{ urlPrefix }}/about/" class="mobile-link">{{ 'nav.about' | t(currentLocale) }}</a>
            <a href="{{ urlPrefix }}/contact/" class="mobile-link">{{ 'nav.contact' | t(currentLocale) }}</a>
        </div>
    </nav>
</div>

<!-- Search is now handled by search-modal.html in base.html -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Wire up all search buttons to open the modal
    const searchBtns = document.querySelectorAll('#search-btn, #search-btn-mobile, #search-btn-menu');
    searchBtns.forEach(btn => {
        btn?.addEventListener('click', () => {
            if (typeof openSearch === 'function') openSearch();
        });
    });
});
</script>
