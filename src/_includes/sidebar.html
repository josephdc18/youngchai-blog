{% set currentLocale = locale | default('en') %}

<div class="sidebar-col desktop-only">
    <div class="sticky-wrapper">
        <div class="widget-box">
            <div class="corner-tr"></div>
            <div class="corner-bl"></div>

            <div class="widget-header">
                <i data-lucide="coffee" class="text-accent" width="20" height="20"></i>
                <h3 class="italic" style="font-size: 1.25rem;">{{ 'blog.popularPosts' | t(currentLocale) }}</h3>
            </div>

            <ul class="widget-list">
                {% set popularPosts = collections.popular_en | default(collections.popular) | default([]) %}
                {% if popularPosts | length > 0 %}
                    {%- for post in popularPosts | head(5) -%}
                        {%- set index = loop.index -%}
                        <li class="group">
                            <div class="widget-list-meta">
                                <span class="widget-num">{{ index | padStart(2, '0') }}</span>
                                <span class="widget-tag">{{ post.data.category | upper | default('BLOG') }}</span>
                            </div>
                            <a href="{{ post.url }}">
                                <h4 class="widget-title">{{ post.data.title | default(post.data.blogTitle) }}</h4>
                            </a>
                        </li>
                    {%- endfor -%}
                {% else %}
                    <li>
                        <p class="post-excerpt" style="font-size: 0.9rem;">Featured reads will appear here once posts are tagged "popular".</p>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</div>
